<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.98.0"><meta name=generator content="Relearn 5.20.0"><meta name=description content><meta name=author content="Choria Project"><title>KV Command Type :: Choria Application Builder Documentation</title><link href=https://choria-io.github.io/appbuilder/css/fontawesome-all.min.css?1713337858 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=https://choria-io.github.io/appbuilder/css/fontawesome-all.min.css?1713337858 rel=stylesheet></noscript><link href=https://choria-io.github.io/appbuilder/css/nucleus.css?1713337858 rel=stylesheet><link href=https://choria-io.github.io/appbuilder/css/auto-complete.css?1713337858 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=https://choria-io.github.io/appbuilder/css/auto-complete.css?1713337858 rel=stylesheet></noscript><link href=https://choria-io.github.io/appbuilder/css/perfect-scrollbar.min.css?1713337858 rel=stylesheet><link href=https://choria-io.github.io/appbuilder/css/fonts.css?1713337858 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=https://choria-io.github.io/appbuilder/css/fonts.css?1713337858 rel=stylesheet></noscript><link href=https://choria-io.github.io/appbuilder/css/theme.css?1713337858 rel=stylesheet><link href=https://choria-io.github.io/appbuilder/css/theme-my-custom-variant.css?1713337858 rel=stylesheet id=variant-style><link href=https://choria-io.github.io/appbuilder/css/variant.css?1713337858 rel=stylesheet><link href=https://choria-io.github.io/appbuilder/css/print.css?1713337858 rel=stylesheet media=print><link href=https://choria-io.github.io/appbuilder/css/ie.css?1713337858 rel=stylesheet><script src=https://choria-io.github.io/appbuilder/js/url.js?1713337858></script>
<script src=https://choria-io.github.io/appbuilder/js/variant.js?1713337858></script>
<script>window.index_json_url="https://choria-io.github.io/appbuilder/index.json";var root_url="https://choria-io.github.io/appbuilder/",baseUriFull,baseUri=root_url.replace(/\/$/,'');window.T_Copy_to_clipboard="Copy to clipboard",window.T_Copied_to_clipboard="Copied to clipboard!",window.T_Copy_link_to_clipboard="Copy link to clipboard",window.T_Link_copied_to_clipboard="Copied link to clipboard!",window.T_No_results_found="No results found for \u0022{0}\u0022",window.T_N_results_found="{1} results found for \u0022{0}\u0022",baseUriFull="https://choria-io.github.io/appbuilder/",window.variants&&variants.init(["my-custom-variant"])</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-YW7H6PL0TN"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-YW7H6PL0TN",{anonymize_ip:!1})}</script><script src=https://cdn.counter.dev/script.js data-id=a4622abe-f6fa-4cac-a337-a4437915e4b3></script></head><body class="mobile-support html disableInlineCopyToClipboard" data-url=https://choria-io.github.io/appbuilder/reference/kv/index.html><div id=body class=default-animation><div id=sidebar-overlay></div><div id=toc-overlay></div><nav id=topbar class=highlightable><div><div class=navigation><a class="nav nav-next topbar-link" href=https://choria-io.github.io/appbuilder/reference/templating/index.html title="Templating (&#129106;)"><i class="fas fa-chevron-right fa-fw"></i></a></div><div class=navigation><a class="nav nav-prev topbar-link" href=https://choria-io.github.io/appbuilder/reference/rpc/index.html title="Choria RPC Command Type (&#129104;)"><i class="fas fa-chevron-left fa-fw"></i></a></div><div id=breadcrumbs><span id=sidebar-toggle-span><a href=# id=sidebar-toggle class=topbar-link title="Menu (CTRL+ALT+n)"><i class="fas fa-bars fa-fw"></i></a></span>
<span id=toc-menu title="Table of Contents (CTRL+ALT+t)"><i class="fas fa-list-alt fa-fw"></i></span><ol class=links itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=https://choria-io.github.io/appbuilder/index.html><span itemprop=name>Choria Application Builder Documentation</span></a><meta itemprop=position content="1">></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=https://choria-io.github.io/appbuilder/reference/index.html><span itemprop=name>Reference</span></a><meta itemprop=position content="2">></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>KV Command Type</span><meta itemprop=position content="3"></li></ol></div><div class="default-animation progress"><div class=toc-wrapper><nav id=TableOfContents><ul><li><a href=#overview>Overview</a></li><li><a href=#writing-data-using-put>Writing data using <code>put</code></a></li><li><a href=#retrieving-data-and-transformations-using-get>Retrieving data and transformations using <code>get</code></a></li><li><a href=#deleting-data-using-del>Deleting data using <code>del</code></a></li><li><a href=#viewing-key-history-using-history>Viewing key history using <code>history</code></a></li></ul></nav></div></div></div></nav><main id=body-inner class="highlightable default" tabindex=-1><div class=flex-block-wrapper><article class=default><header class=headline></header><h1 id=kv-command-type>KV Command Type</h1><p>The KV command interact with the Choria Key-Value Store and supports usual operations such as Get, Put, Delete and more.</p><p>Since this is built into Choria it will simply use your Choria Client configuration for the user executing the command
to find the Choria Brokers and more. It supports the usual override methods such as creating a <code>choria.conf</code> file in
your project working directory. No connection properties are required or supported.</p><div class="box notices cstyle secondary"><div class=box-label><i class="fa-fw fas fa-code-branch"></i> Version Hint</div><div class=box-content><p>This feature is only available when hosting App Builder applications within the Choria Server version 0.26.0 or newer</p></div></div><h2 id=overview>Overview</h2><p>All variations of this command have a number of required properties, here&rsquo;s the basic <code>get</code> operation, all these keys are required:</p><div class="wrap-code highlight"><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#ae81ff>version</span>
</span></span><span style=display:flex><span><span style=color:#f92672>description</span>: <span style=color:#ae81ff>Retrieve the `version` key</span>
</span></span><span style=display:flex><span><span style=color:#f92672>type</span>: <span style=color:#ae81ff>kv</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>action</span>: <span style=color:#ae81ff>get</span>
</span></span><span style=display:flex><span><span style=color:#f92672>bucket</span>: <span style=color:#ae81ff>DEPLOYMENT</span>
</span></span><span style=display:flex><span><span style=color:#f92672>key</span>: <span style=color:#ae81ff>version</span></span></span></code></pre></div><p>Usual standard properties like <code>flags</code>, <code>arguments</code>, <code>commands</code> and so forth are all supported. The <code>bucket</code> and <code>key</code> flags supports <a href=../templating/>templating</a>.</p><h2 id=writing-data-using-put>Writing data using <code>put</code></h2><p>Data can be written to the bucket, it&rsquo;s identical to the above example with the addition of the <code>value</code> property that supports <a href=../templating/>templating</a>.</p><div class="wrap-code highlight"><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#ae81ff>version</span>
</span></span><span style=display:flex><span><span style=color:#f92672>description</span>: <span style=color:#ae81ff>Stores a new version for the deployment</span>
</span></span><span style=display:flex><span><span style=color:#f92672>type</span>: <span style=color:#ae81ff>kv</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>action</span>: <span style=color:#ae81ff>put</span>
</span></span><span style=display:flex><span><span style=color:#f92672>bucket</span>: <span style=color:#ae81ff>DEPLOYMENT</span>
</span></span><span style=display:flex><span><span style=color:#f92672>key</span>: <span style=color:#ae81ff>version</span>
</span></span><span style=display:flex><span><span style=color:#f92672>value</span>: <span style=color:#e6db74>&#39;{{- .Arguments.version -}}&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>arguments</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>version</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>description</span>: <span style=color:#ae81ff>The version to store</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>required</span>: <span style=color:#66d9ef>true</span></span></span></code></pre></div><h2 id=retrieving-data-and-transformations-using-get>Retrieving data and transformations using <code>get</code></h2><p>Stored data can be retrieved and rendered to the screen, typically the value is just dumped. Keys and Values however have
additional metadata that can be rendered in JSON format.</p><div class="wrap-code highlight"><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#ae81ff>version</span>
</span></span><span style=display:flex><span><span style=color:#f92672>description</span>: <span style=color:#ae81ff>Retrieve the `version` key</span>
</span></span><span style=display:flex><span><span style=color:#f92672>type</span>: <span style=color:#ae81ff>kv</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>action</span>: <span style=color:#ae81ff>get</span>
</span></span><span style=display:flex><span><span style=color:#f92672>bucket</span>: <span style=color:#ae81ff>DEPLOYMENT</span>
</span></span><span style=display:flex><span><span style=color:#f92672>key</span>: <span style=color:#ae81ff>state</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Triggers rendering the KV entry as JSON that will include metadata ab out the value.</span>
</span></span><span style=display:flex><span><span style=color:#f92672>json</span>: <span style=color:#66d9ef>true</span></span></span></code></pre></div><p>Further if it&rsquo;s known that the entry holds JSON data it can be formatted using <a href=../transformations>data transformations</a>:</p><div class="wrap-code highlight"><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#ae81ff>version</span>
</span></span><span style=display:flex><span><span style=color:#f92672>description</span>: <span style=color:#ae81ff>Retrieve the `version` key</span>
</span></span><span style=display:flex><span><span style=color:#f92672>type</span>: <span style=color:#ae81ff>kv</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>action</span>: <span style=color:#ae81ff>get</span>
</span></span><span style=display:flex><span><span style=color:#f92672>bucket</span>: <span style=color:#ae81ff>DEPLOYMENT</span>
</span></span><span style=display:flex><span><span style=color:#f92672>key</span>: <span style=color:#ae81ff>state</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>transform</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>query</span>: <span style=color:#ae81ff>.state</span></span></span></code></pre></div><h2 id=deleting-data-using-del>Deleting data using <code>del</code></h2><p>Deleting a specific key is very similar to a basic retrieve, just use a different <code>action</code>:</p><div class="wrap-code highlight"><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#ae81ff>version</span>
</span></span><span style=display:flex><span><span style=color:#f92672>description</span>: <span style=color:#ae81ff>Deletes the deployment configuration property</span>
</span></span><span style=display:flex><span><span style=color:#f92672>type</span>: <span style=color:#ae81ff>kv</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>action</span>: <span style=color:#ae81ff>del</span>
</span></span><span style=display:flex><span><span style=color:#f92672>bucket</span>: <span style=color:#ae81ff>DEPLOYMENT</span>
</span></span><span style=display:flex><span><span style=color:#f92672>key</span>: <span style=color:#ae81ff>configuration</span></span></span></code></pre></div><h2 id=viewing-key-history-using-history>Viewing key history using <code>history</code></h2><p>Choria Key-Value store optionally has historical data for keys, the data can be shown in tabular (default) or JSON formats:</p><div class="wrap-code highlight"><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#ae81ff>version</span>
</span></span><span style=display:flex><span><span style=color:#f92672>description</span>: <span style=color:#ae81ff>Deploy version history</span>
</span></span><span style=display:flex><span><span style=color:#f92672>type</span>: <span style=color:#ae81ff>kv</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>action</span>: <span style=color:#ae81ff>history</span>
</span></span><span style=display:flex><span><span style=color:#f92672>bucket</span>: <span style=color:#ae81ff>DEPLOYMENT</span>
</span></span><span style=display:flex><span><span style=color:#f92672>key</span>: <span style=color:#ae81ff>version</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># optionally renders the result as JSON</span>
</span></span><span style=display:flex><span><span style=color:#f92672>json</span>: <span style=color:#66d9ef>true</span></span></span></code></pre></div><footer class=footline></footer></article></div></main></div><aside id=sidebar class=default-animation><div id=header-topbar class=default-animation></div><div id=header-wrapper class=default-animation><div id=header class=default-animation><img src=https://choria-io.github.io/appbuilder/logo.png></div><div class="searchbox default-animation"><i class="fas fa-search" title="Search (CTRL+ALT+f)"></i>
<label class=a11y-only for=search-by>Search</label>
<input data-search-input id=search-by name=search-by class=search-by type=search placeholder=Search...>
<button class=search-clear type=button data-search-clear title="Clear search"><i class="fas fa-times" title="Clear search"></i></button></div><script>var contentLangs=[]</script><script src=https://choria-io.github.io/appbuilder/js/auto-complete.js?1713337858 defer></script>
<script src=https://choria-io.github.io/appbuilder/js/lunr/lunr.min.js?1713337858 defer></script>
<script src=https://choria-io.github.io/appbuilder/js/lunr/lunr.stemmer.support.min.js?1713337858 defer></script>
<script src=https://choria-io.github.io/appbuilder/js/lunr/lunr.multi.min.js?1713337858 defer></script>
<script src=https://choria-io.github.io/appbuilder/js/search.js?1713337858 defer></script></div><div id=homelinks class="default-animation homelinks"><ul><li><a class=padding href=https://choria-io.github.io/appbuilder/index.html><i class="fas fa-home"></i> Home</a></li></ul><hr class=padding></div><div id=content-wrapper class=highlightable><div id=topics><ul class="enlarge morespace"><li data-nav-id=/quick-start/index.html><a class=padding href=https://choria-io.github.io/appbuilder/quick-start/index.html><b>1. </b>Quick Start</a></li><li data-nav-id=/reference/index.html class="parent alwaysopen"><a class=padding href=https://choria-io.github.io/appbuilder/reference/index.html><b>2. </b>Reference</a><ul id=subsections-aaf4dc0c3ad418fa5118c9d2a0c2270f class=morespace><li data-nav-id=/reference/common-settings/index.html><a class=padding href=https://choria-io.github.io/appbuilder/reference/common-settings/index.html>Common Settings</a></li><li data-nav-id=/reference/parent/index.html><a class=padding href=https://choria-io.github.io/appbuilder/reference/parent/index.html>Parent Command Type</a></li><li data-nav-id=/reference/exec/index.html><a class=padding href=https://choria-io.github.io/appbuilder/reference/exec/index.html>Exec Command Type</a></li><li data-nav-id=/reference/scaffold/index.html><a class=padding href=https://choria-io.github.io/appbuilder/reference/scaffold/index.html>Scaffold Command Type</a></li><li data-nav-id=/reference/discovery/index.html><a class=padding href=https://choria-io.github.io/appbuilder/reference/discovery/index.html>Discover Command Type</a></li><li data-nav-id=/reference/rpc/index.html><a class=padding href=https://choria-io.github.io/appbuilder/reference/rpc/index.html>Choria RPC Command Type</a></li><li data-nav-id=/reference/kv/index.html class=active><a class=padding href=https://choria-io.github.io/appbuilder/reference/kv/index.html>KV Command Type</a></li><li data-nav-id=/reference/templating/index.html><a class=padding href=https://choria-io.github.io/appbuilder/reference/templating/index.html>Templating</a></li><li data-nav-id=/reference/transformations/index.html><a class=padding href=https://choria-io.github.io/appbuilder/reference/transformations/index.html>Transformations</a></li><li data-nav-id=/reference/configuration/index.html><a class=padding href=https://choria-io.github.io/appbuilder/reference/configuration/index.html>Configuration</a></li><li data-nav-id=/reference/cheats/index.html><a class=padding href=https://choria-io.github.io/appbuilder/reference/cheats/index.html>Cheat Sheets</a></li><li data-nav-id=/reference/file-locations/index.html><a class=padding href=https://choria-io.github.io/appbuilder/reference/file-locations/index.html>File Locations</a></li><li data-nav-id=/reference/running-validation/index.html><a class=padding href=https://choria-io.github.io/appbuilder/reference/running-validation/index.html>Runtime Settings and Tools</a></li></ul></li><li data-nav-id=/tasks/index.html><a class=padding href=https://choria-io.github.io/appbuilder/tasks/index.html><b>3. </b>Local Task Mode</a></li><li data-nav-id=/experiments/index.html><a class=padding href=https://choria-io.github.io/appbuilder/experiments/index.html><b>4. </b>Experiments</a></li></ul></div><div id=shortcuts><div class="nav-title padding">More</div><ul class=space><li><a class=padding href=https://github.com/choria-io/appbuilder><i class="fab fa-fw fa-github"></i> GitHub</a></li><li><a class=padding href=https://github.com/choria-io/appbuilder/releases><i class="far fa-save"></i> Download</a></li><li><a class=padding href=https://github.com/choria-io/appbuilder/discussions><i class="far fa-comments"></i> Discussions</a></li><li><a class=padding href=https://github.com/choria-io/appbuilder/issues><i class="far fa-life-ring"></i> Issues</a></li><li><a class=padding href=https://slack.puppet.com/><i class="fab fa-slack"></i> #choria</a></li></ul></div><div class="padding footermargin footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showFooter"></div><div id=menu-footer><hr class="padding default-animation footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showFooter"><div id=prefooter class="footerLangSwitch footerVariantSwitch footerVisitedLinks"><ul><li id=select-language-container class=footerLangSwitch><div class="padding menu-control"><i class="fas fa-language fa-fw"></i>
<span>&nbsp;</span><div class=control-style><label class=a11y-only for=select-language>Language</label>
<select id=select-language onchange="location=baseUri+this.value"></select></div><div class=clear></div></div></li><li id=select-variant-container class=footerVariantSwitch><div class="padding menu-control"><i class="fas fa-paint-brush fa-fw"></i>
<span>&nbsp;</span><div class=control-style><label class=a11y-only for=select-variant>Theme</label>
<select id=select-variant onchange=window.variants&&variants.changeVariant(this.value)><option id=my-custom-variant value=my-custom-variant selected>My Custom Variant</option></select></div><div class=clear></div></div><script>window.variants&&variants.markSelectedVariant()</script></li><li class=footerVisitedLinks><div class="padding menu-control"><i class="fas fa-history fa-fw"></i>
<span>&nbsp;</span><div class=control-style><button onclick=clearHistory()>Clear History</button></div><div class=clear></div></div></li></ul></div><div id=footer class="footerFooter showFooter"><p>Built with <a href=https://github.com/McShelby/hugo-theme-relearn title=love><i class="fas fa-heart"></i></a> by <a href=https://gohugo.io/>Hugo</a></p></div></div></div></aside><script src=https://choria-io.github.io/appbuilder/js/clipboard.min.js?1713337858 defer></script>
<script src=https://choria-io.github.io/appbuilder/js/perfect-scrollbar.min.js?1713337858 defer></script>
<script src=https://choria-io.github.io/appbuilder/js/theme.js?1713337858 defer></script></body></html>